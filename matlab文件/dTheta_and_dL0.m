    syms  phi_0 phi_1 phi_2 phi_4 L1 L2 L3 L4 L5 L0 d_phi1 d_phi4
    
    XD=L5+L4*cos(phi_4);
    YD=L4*sin(phi_4);
    XB=L1*cos(phi_1);
    YB=L1*sin(phi_1);
    A0=2*L2*(XD-XB);
    B0=2*L2*(YD-YB);
    lBD=sqrt((XD-XB)^2+(YD-YB)^2);
    C0=L2^2+lBD^2-L3^2;
    phi_2=2*atan((B0+sqrt(A0^2+B0^2-C0^2))/(A0+C0));
    XC=XB+L2*cos(phi_2);
    YC=YB+L2*sin(phi_2);
    L0=sqrt((XC-L5/2)^2+YC^2);
    phi_0=atan(YC/(XC-L5/2));
    
    J=jacobian([L0;phi_0],[phi_1;phi_4]);
    phi0_dot = J(2,1)*d_phi1 +J(2,2)*d_phi4
    L0_dot = J(1,1)*d_phi1 +J(1,2)*d_phi4
%     jacobian函数无法在simulink中使用，故直接使用jacobian函数的最终结果

% 结果如下
% phi0_dot = (d_phi1*((L1*cos(phi_1) + (2*L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L1*L2^2*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L1*L2^2*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L1*L2*cos(phi_1))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*L2*sin(phi_1) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2))/((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1))/(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1)) - ((L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1))*(L1*sin(phi_1) - (2*L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L1*L2^2*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L1*L2^2*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L1*L2*cos(phi_1))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*L2*sin(phi_1) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2))/((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1)))/(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1))^2))/((L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1))^2/(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1))^2 + 1) - (d_phi4*((2*L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L2^2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L2^2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L2*L4*cos(phi_4))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L2*L4*sin(phi_4) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2))/(((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1)*(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1))) + (2*L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L2^2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L2^2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L2*L4*cos(phi_4))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L2*L4*sin(phi_4) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2)*(L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1)))/(((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1)*(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1))^2)))/((L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1))^2/(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1))^2 + 1)
% L0_dot = (d_phi4*((4*L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L2^2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L2^2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L2*L4*cos(phi_4))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L2*L4*sin(phi_4) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2)*(L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1)))/((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1) - (4*L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L2^2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L2^2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L2*L4*cos(phi_4))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L4*sin(phi_4)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L2*L4*sin(phi_4) + 2*L4*cos(phi_4)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2)*(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1)))/((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1)))/(2*((L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1))^2 + (L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1))^2)^(1/2)) - (d_phi1*(2*(L1*sin(phi_1) - (2*L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L1*L2^2*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L1*L2^2*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L1*L2*cos(phi_1))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*L2*sin(phi_1) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2))/((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1))*(L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1)) + 2*(L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1))*(L1*cos(phi_1) + (2*L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)))*(((8*L1*L2^2*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)) - 2*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4)))*((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + 8*L1*L2^2*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)))/(2*(4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2)) - 2*L1*L2*cos(phi_1))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2) + ((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))*(2*L1*sin(phi_1)*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + 2*L1*L2*sin(phi_1) + 2*L1*cos(phi_1)*(L1*sin(phi_1) - L4*sin(phi_4))))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2))/((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))^2/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 1))))/(2*((L2*cos(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L5/2 + L1*cos(phi_1))^2 + (L2*sin(2*atan((2*L2*(L1*sin(phi_1) - L4*sin(phi_4)) - (4*L2^2*(L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 - ((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2)^2 + 4*L2^2*(L1*sin(phi_1) - L4*sin(phi_4))^2)^(1/2))/((L5 - L1*cos(phi_1) + L4*cos(phi_4))^2 + 2*L2*(L5 - L1*cos(phi_1) + L4*cos(phi_4)) + L2^2 - L3^2 + (L1*sin(phi_1) - L4*sin(phi_4))^2))) - L1*sin(phi_1))^2)^(1/2))